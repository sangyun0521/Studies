# DBMS
데이터베이스는 사용자가 어플리케이션 로직 개발에 집중할 수 있도록 데이터를 저장하고 제공한다. 

데이터베이스는 여러 모듈로 구성된다
* 전송 계층
* 쿼리 프로세서
* 실행 엔진
* 스토리지 엔진

실행 엔진 : 사용자로 부터 요청을 받아 분석하고 가장 효율적인 실행 계획을 생성 
스토리지 엔진 : 메모리 및 디스크에 데이터를 저장 및 검색

여러 데이터베이스 (MySQL, MongDB 등)들은 실제로 여러가지 스토리지 엔진을 플러그형으로 제공하여 사용자가 자신에게 적합한 스토리지 엔진을 사용할 수 있도록한다.

예를 들어 MySQL에는 InnoDB와 MyISAM 등의 스토리지 엔진이 있다. 
* InnoDB는 트랜잭션, 높은 동시성 처리 등을 지원하는 조금은 무거운 엔진이다.
* MyISAM은 반대로 이런 기능들을 지원하지 않는 대신 가벼우며 읽기 성능이 매우 빠른 엔진이다. 

# DBMS 비교
* 데이터베이스를 변경해야 하는 경우 엄청난 마이그레이션 비용을 지불해야 하기 때문에 적절한 데이터베이스를 선택하는 것이 중요
* 실제 사용환경과 비슷한 테스트 환경에서 데이터베이스를 운영해보는 것이 좋다. 
* 스키마와 레코드 크기, 클라이언트 수, 쿼리 형식, 읽기/쓰기 비율, 클러스터 확장 가능 여부 등의 지표들을 미리 예측해야한다.

Transaction Processing Performance Council 에서는 데이터베이스 벤치마크를 제공한다. 
* TPC-C : OLTP 벤치마크
* TPC-H : OLAP 벤치마크

# 데이터베이스 구조
데이터베이스 마다 구조가 다르지만 어느 정도 공통된 구조를 정리해 볼 수 있다.

![[Pasted image 20250304193703.png]]
* 트탠스포트는 통신을 담당는 모듈로 클라이언트로 부터 요청을 받아 쿼리 프로세서로 전달한다. 또는 클러스터 노드간 통신에 도 사용한다
* 쿼리 프로세서는 쿼리를 파서를 통해 쿼리의 의미를 파악한다
* 쿼리 프로세서는 쿼리 옵티마이저를 통해 실행 계획을 세운다 (내부 데이터 통계, 데이터 위치 정보 등을 사용)
* 실행 계획이 선택되면 실행 엔진에 의해 실행된다. 클러스터내 노드 사이의 데이터 읽기, 쓰기를 실행할 수 도 있으며 로컬 쿼리를 스토리지 엔진에게 요청한다
* 스토리지 엔진은 로컬 쿼리를 수행한다. 이 때, 트랜잭션, 락, 액세스 방식, 버퍼, 리두, 언두 로그 등 다양한 요소를 담당한다. 

# 인메모리 DBMS vs 디스크 DBMS 
* 메모리는 디스크 보다 훨씬 빠르지만 비싸고 휘발성이라는 특징을 가진다. 
* 때문에 메모리는 빠르고 프로그래밍이 더 쉽지만 데이터가 손실될 수 있다. 
* 데이터 지속성 보장을 위해 WAL (write ahead logging)
* 복구시 모든 로그를 적용하는 비용을 줄이기 위한 체크포인팅
* 체크포인팅은 성능을 위해 비동기로 수행되며 배치 단위로 작업이 이루어짐

# 칼럼형 DBMS vs 로우형 DBMS
일반적으로 우리가 생각하는 DBMS는 로우형 DBMS일 것이다. 
* 로우형 : 하나의 로우에 속하는 값들을 함께 저장하는 방식
* 칼럼형 : 그 반대로 테이블을 컬럼별로 저장하는 방식

장단점을 생각해보면 
* 사용자 정보 검색과 같이 전체 로우 정보가 필요한 경우에는 로우형 DBMS가 유리
* 모든 사용자의 자산 총액, 평균 등과 같은 집계 분석 작업에는 컬럼형 DBMS가 유리

또한,
* 컬럼형 DBMS를 사용하면 캐시 활용도가 높아지며 같은 자료형으로 저장하는 경우 압축률이 증가한다.

# 와이드 칼럼 스토어 